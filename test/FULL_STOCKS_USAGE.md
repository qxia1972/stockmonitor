# 全量股票获取功能使用说明

## 功能概述

当 `target_stocks` 配置为空时，系统会自动从 RQDatac 获取全量沪深活跃股票，并排除 ST/PT 等特殊股票。

## 配置方式

### 1. 自动获取全量股票（推荐）

```python
# 在 dagster_config.py 中设置
self.target_stocks = []  # 留空即可
```

### 2. 指定特定股票

```python
# 指定特定的股票列表
self.target_stocks = [
    "000001.XSHE", "000002.XSHE", "600000.XSHG",
    "600036.XSHG", "000858.XSHE", "600519.XSHG"
]
```

## 过滤规则

系统会自动应用以下过滤条件：

1. **状态过滤**：只选择 `status == "Active"` 的股票
2. **市场过滤**：只选择沪深市场股票（`*.XSHG` 或 `*.XSHE`）
3. **特殊股票过滤**：排除包含 `ST`、`PT`、`*` 的股票名称

## 处理流程

```
配置检查 → RQDatac获取 → 过滤处理 → 返回股票列表
    ↓            ↓            ↓            ↓
  target_stocks  全量A股     活跃沪深     排除ST/PT
  为空检查      5489只      4984只       4984只
```

## 日志输出示例

```
⚠️ 未配置目标股票，从RQDatac获取全部沪深股票列表
📊 从RQDatac获取到 5489 只证券
✅ 过滤后得到 4984 只活跃沪深股票（已排除ST/PT股票）
🚫 已排除 170 只ST/PT股票
🎯 最终目标股票数量: 4984
```

## 注意事项

1. **API限制**：确保 RQDatac API 可用且账户有效
2. **性能考虑**：全量股票处理可能需要较长时间
3. **内存使用**：大量股票数据会增加内存消耗
4. **网络稳定**：建议在网络稳定的环境下运行

## 故障排除

- 如果获取失败，会自动使用默认股票列表
- 检查 RQDatac 账户状态和网络连接
- 查看日志中的详细错误信息