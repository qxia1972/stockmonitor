import pandas as pd
import numpy as np
import sys
sys.path.append('modules')

print('ğŸš€ OHLCV DataFrame API æ¼”ç¤º')
print('=' * 40)

# åˆ›å»ºç¤ºä¾‹æ•°æ®
data = {
    'open': [100, 101, 102, 103, 104, 105, 106, 107, 108, 109],
    'high': [102, 103, 104, 105, 106, 107, 108, 109, 110, 111],
    'low': [99, 100, 101, 102, 103, 104, 105, 106, 107, 108],
    'close': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
    'volume': [1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900]
}
df = pd.DataFrame(data)

print('æ•°æ®é¢„è§ˆ:')
print(df.head())
print()

from modules.indicator_manager import calculate_sma, calculate_ema, calculate_stochastic

print('âœ… æ–°APIä½¿ç”¨ç¤ºä¾‹:')
print()

# å•ä»·æ ¼æŒ‡æ ‡ - ç®€æ´è°ƒç”¨
sma = calculate_sma(df, 5)  # é»˜è®¤ä½¿ç”¨closeåˆ—
ema = calculate_ema(df, 5)
print(f'SMA(5): {sma.iloc[-1]:.2f}')
print(f'EMA(5): {ema.iloc[-1]:.2f}')
print()

# å¤šä»·æ ¼æŒ‡æ ‡ - ä¸€ä¸ªDataFrameæå®š
stoch = calculate_stochastic(df, k_period=5, d_period=3)
print(f'Stochastic K: {stoch["stoch_k"].iloc[-1]:.2f}')
print(f'Stochastic D: {stoch["stoch_d"].iloc[-1]:.2f}')
print()

# æŒ‡å®šä¸åŒä»·æ ¼åˆ—
sma_open = calculate_sma(df, 5, price_column='open')
print(f'SMA(open, 5): {sma_open.iloc[-1]:.2f}')
print()

print('ğŸ¯ å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼çš„ä¼˜åŠ¿:')
print('  ä¼ ç»Ÿ: calculate_sma(df["close"], 5)')
print('  æ–°å¼: calculate_sma(df, 5)')
print('  ä¼ ç»Ÿ: calculate_stochastic(df["high"], df["low"], df["close"])')
print('  æ–°å¼: calculate_stochastic(df)')
print()
print('âœ¨ ä»£ç æ›´ç®€æ´ï¼Œæ›´å°‘å‡ºé”™ï¼Œæ›´æ˜“ç»´æŠ¤ï¼')
